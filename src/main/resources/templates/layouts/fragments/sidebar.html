<div th:fragment="sidebar" xmlns:th="http://www.thymeleaf.org">

    <aside id="sidebarMenu" class="sm-sidebar" aria-hidden="true" role="navigation">
        <div class="sm-title">
            <strong class="ms-1">Akses Cepat</strong>
        </div>

        <nav class="sm-nav">

            <a th:href="@{/}" class="sm-nav-btn" th:classappend="${page=='dashboard'} ? ' active'"
               th:if="${#authorization.expression('isAuthenticated()')}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M3 12l9-9 9 9M4 10v10a1 1 0 001 1h4a1 1 0 001-1v-4h4v4a1 1 0 001 1h4a1 1 0 001-1V10" />
                </svg>
                <span>Dashboard</span>
            </a>

            <a th:href="@{/users}" class="sm-nav-btn" th:classappend="${page=='users'} ? ' active'"
               th:if="${#authorization.expression('hasAuthority(''ADMINISTRATOR'')')}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M12 14c4.418 0 8 1.79 8 4v2H4v-2c0-2.21 3.582-4 8-4zm0-8a4 4 0 110 8 4 4 0 010-8z" />
                </svg>
                <span>Pengguna</span>
            </a>

            <a th:href="@{/companies}" class="sm-nav-btn" th:classappend="${page=='companies'} ? ' active'"
               th:if="${#authorization.expression('hasAuthority(''ADMINISTRATOR'')')}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M3 21h18M9 8h6m-6 4h6M4 21V7a1 1 0 011-1h14a1 1 0 011 1v14" />
                </svg>
                <span>Perusahaan</span>
            </a>

            <a th:href="@{/placements}" class="sm-nav-btn" th:classappend="${page=='placements'} ? ' active'"
               th:if="${#authorization.expression('hasAnyAuthority(''ADMINISTRATOR'', ''SCHOOL_SUPERVISOR'', ''School_Supervisor'', ''COMPANY_SUPERVISOR'', ''Company_Supervisor'')')}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M12 21s8-4.5 8-10A8 8 0 104 11c0 5.5 8 10 8 10z" />
                    <circle cx="12" cy="11" r="2.5" />
                </svg>
                <span>Data Penempatan</span>
            </a>

            <a th:href="@{/my-placements}" class="sm-nav-btn" th:classappend="${page=='placements'} ? ' active'"
               th:if="${#authorization.expression('hasAnyAuthority(''STUDENT'', ''Student'')')}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
                <span>Lokasi PKL Saya</span>
            </a>

            <a th:href="@{/attendances}" class="sm-nav-btn" th:classappend="${page=='attendances'} ? ' active'"
               th:if="${#authorization.expression('hasAnyAuthority(''ADMINISTRATOR'', ''SCHOOL_SUPERVISOR'', ''School_Supervisor'', ''COMPANY_SUPERVISOR'', ''Company_Supervisor'')')}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                </svg>
                <span>Data Absensi</span>
            </a>

            <a th:href="@{/my-attendance}" class="sm-nav-btn" th:classappend="${page=='attendances'} ? ' active'"
               th:if="${#authorization.expression('hasAnyAuthority(''STUDENT'', ''Student'')')}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M12 4v16m8-8H4" />
                </svg>
                <span>Isi Absensi</span>
            </a>


            <a th:href="@{/daily-journal}" class="sm-nav-btn" th:classappend="${page=='journals'} ? ' active'"
               th:if="${#authorization.expression('hasAnyAuthority(''ADMINISTRATOR'', ''STUDENT'', ''Student'', ''SCHOOL_SUPERVISOR'', ''School_Supervisor'', ''COMPANY_SUPERVISOR'', ''Company_Supervisor'')')}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01" />
                </svg>
                <span>Laporan Harian</span>
            </a>

            <a th:href="@{/report-submissions}" class="sm-nav-btn" th:classappend="${page=='reports'} ? ' active'"
               th:if="${#authorization.expression('hasAnyAuthority(''ADMINISTRATOR'', ''STUDENT'', ''Student'', ''SCHOOL_SUPERVISOR'', ''School_Supervisor'')')}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M4 4h16v16H4zM4 4l8 8-8 8" />
                </svg>
                <span>Laporan Akhir</span>
            </a>

            <a th:href="@{/my-profile}" class="sm-nav-btn"
               th:classappend="${page=='profile'} ? ' active'"
               th:if="${!#authorization.expression('hasAnyAuthority(''ADMINISTRATOR'', ''ROLE_ADMINISTRATOR'')')}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                <span>Profil Saya</span>
            </a>

            <a th:href="@{/grades}" class="sm-nav-btn" th:classappend="${page=='grades'} ? ' active'"
               th:if="${#authorization.expression('hasAnyAuthority(''ADMINISTRATOR'', ''STUDENT'', ''Student'', ''SCHOOL_SUPERVISOR'', ''School_Supervisor'')')}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M12 3l3.09 6.26L22 10l-5 4.87L18.18 22 12 18.56 5.82 22 7 14.87 2 10l6.91-1.74L12 3z" />
                </svg>
                <span>Nilai</span>
            </a>

        </nav>
    </aside>

    <style>
        :root { --navy: #0b2340; --accent: #b78b4a; --muted: #6c757d; }
        .sm-sidebar { position: fixed; top: 56px; left: 0; bottom: 0; width: 260px; background: #ffffff; box-shadow: 0 10px 40px rgba(11, 35, 64, 0.1); transform: translateX(-110%); opacity: 0; visibility: hidden; transition: transform .3s ease, opacity .25s ease; z-index: 1400; padding: 1.2rem 1rem; border-radius: 0 12px 12px 0; overflow-y: auto; border-left: 3px solid rgba(183, 139, 74, 0.1); }
        .sm-sidebar.open { transform: translateX(0); opacity: 1; visibility: visible; }
        .sm-title { font-weight: 700; display: flex; align-items: center; gap: .6rem; color: var(--navy); margin-bottom: 1rem; text-transform: uppercase; font-size: .9rem; letter-spacing: .03em; }
        .sm-title svg { width: 20px; height: 20px; stroke: var(--accent); }
        .sm-nav { display: flex; flex-direction: column; gap: .4rem; }
        .sm-nav-btn { display: flex; align-items: center; gap: .8rem; padding: .6rem .7rem; color: var(--navy); font-weight: 600; text-decoration: none; border-radius: 10px; transition: all .25s ease; background: transparent; }
        .sm-nav-btn svg { width: 20px; height: 20px; stroke: var(--accent); transition: all .25s ease; }
        .sm-nav-btn:hover { background: rgba(183, 139, 74, 0.1); transform: translateX(4px); }
        .sm-nav-btn:hover svg { stroke: var(--navy); }
        .sm-nav-btn.active { background: rgba(183, 139, 74, 0.2); border-left: 4px solid var(--accent); transform: translateX(0); }
    </style>

    <script th:inline="javascript">
        (function () {
          const toggleBtn = document.getElementById('toggleSidebarBtn');
          const sidebar = document.getElementById('sidebarMenu');
          const overlay = document.getElementById('pageOverlay');
          if (!toggleBtn || !sidebar) return;
          toggleBtn.addEventListener('click', () => {
            const isOpen = sidebar.classList.contains('open');
            sidebar.classList.toggle('open', !isOpen);
            overlay.classList.toggle('show', !isOpen);
            toggleBtn.setAttribute('aria-expanded', !isOpen);
            document.body.style.overflow = isOpen ? '' : 'hidden';
          });
          overlay.addEventListener('click', () => {
            sidebar.classList.remove('open');
            overlay.classList.remove('show');
            toggleBtn.setAttribute('aria-expanded', 'false');
            document.body.style.overflow = '';
          });
        })();
    </script>
</div>