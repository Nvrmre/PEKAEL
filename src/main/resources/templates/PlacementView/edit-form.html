<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Edit Placement - Sistem Monitoring</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root {
      --navy: #0b2340;
      --cream: #f2ece3;
      --accent: #b78b4a;
      --muted: #6c757d;
      --shadow: 0 6px 18px rgba(11, 35, 64, 0.06);
    }

    body {
      background: var(--cream);
      color: var(--navy);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }

    .container-main {
      max-width: 920px;
      margin: 1.8rem auto;
      padding: 1rem;
    }

    .card-page {
      background: #fff;
      border-radius: 12px;
      padding: 1.25rem;
      box-shadow: var(--shadow);
    }

    .form-title {
      display: flex; gap: .6rem; align-items: center; font-weight: 700; color: var(--navy);
    }

    .card-section {
      background: #fbfaf8;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      border: 1px solid rgba(11, 35, 64, 0.04);
    }

    .input-icon svg { width: 18px; height: 18px; stroke: var(--navy); }

    .btn-save {
      background: var(--accent); color: white; border: none; border-radius: 8px;
      padding: .55rem 1rem; font-weight: 700; display: inline-flex; gap: .5rem; align-items: center;
    }
    .btn-save:hover { background: #a5793e; transform: translateY(-2px); }

    .btn-cancel {
      background: transparent; border: 1px solid rgba(11, 35, 64, 0.08); color: var(--navy);
      border-radius: 8px; padding: .45rem .9rem; font-weight: 600; display: flex; align-items: center;
    }
    .btn-cancel:hover { background: #eee; }
  </style>
</head>

<body>
  <div th:replace="~{layouts/fragments/navbar :: topbar}"></div>
  <div th:replace="~{layouts/fragments/sidebar :: sidebar}"></div>
  <div id="pageOverlay" class="overlay" aria-hidden="true"></div>

  <main class="container-main">
    <div class="card-page">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="form-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" width="26" height="26" style="stroke:var(--accent)">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
          </svg>
          <h4 class="mb-0">Edit Data Penempatan</h4>
        </div>

        <div>
          <a th:href="@{/placements}" class="btn-cancel">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="18" height="18">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
            </svg>
            Kembali
          </a>
        </div>
      </div>

      <form th:action="@{/placements/{id}(id=${placement.placementId})}" th:object="${placement}" method="post">
        
        <input type="hidden" name="_method" value="put" />

        <div class="card-section">
          <div class="row g-3">

            <div class="col-12 col-md-6">
              <label class="form-label">Siswa <span class="text-danger">*</span></label>
              <div class="input-group">
                <span class="input-group-text bg-white input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                </span>
                <select class="form-select" name="studentId" required>
                  <option value="" disabled>— Pilih Siswa —</option>
                  <option th:each="s : ${students}" 
                          th:value="${s.studentId}"
                          th:text="${s.user.username + ' (' + (s.studentNumber ?: '-') + ')'}"
                          th:selected="${placement.student?.studentId == s.studentId}">
                  </option>
                </select>
              </div>
            </div>

            <div class="col-12 col-md-6">
              <label class="form-label">Perusahaan <span class="text-danger">*</span></label>
              <div class="input-group">
                <span class="input-group-text bg-white input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" /></svg>
                </span>
                <select class="form-select" name="companyId" required>
                  <option value="" disabled>— Pilih Perusahaan —</option>
                  <option th:each="c : ${companies}" 
                          th:value="${c.companyId}" 
                          th:text="${c.companyName}"
                          th:selected="${placement.company?.companyId == c.companyId}">
                  </option>
                </select>
              </div>
            </div>

            <div class="col-12 col-md-6">
              <label class="form-label">Pembimbing Sekolah</label>
              <div class="input-group">
                <span class="input-group-text bg-white input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>
                </span>
                <select class="form-select" name="schoolSupervisorId">
                  <option value="">— Tidak Ada —</option>
                  <option th:each="s : ${schoolSupervisors}" 
                          th:value="${s.sSupervisorId}"
                          th:text="${s.schoolSupervisorFullName ?: s.user.username}"
                          th:selected="${placement.schoolSupervisor?.sSupervisorId == s.sSupervisorId}">
                  </option>
                </select>
              </div>
            </div>

            <div class="col-12 col-md-6">
              <label class="form-label">Pembimbing Lapangan</label>
              <div class="input-group">
                <span class="input-group-text bg-white input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg>
                </span>
                <select class="form-select" name="companySupervisorId">
                  <option value="">— Tidak Ada —</option>
                  <option th:each="cs : ${companySupervisors}" 
                          th:value="${cs.cSupervisorId}"
                          th:text="${cs.companySupervisorFullName ?: cs.user.username}"
                          th:selected="${placement.companySupervisor?.cSupervisorId == cs.cSupervisorId}">
                  </option>
                </select>
              </div>
            </div>

            <div class="col-12 col-md-6">
              <label class="form-label">Tanggal Mulai <span class="text-danger">*</span></label>
              <div class="input-group">
                <span class="input-group-text bg-white input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                </span>
                <input type="datetime-local" class="form-control" name="startDate"
                       th:value="${placement.startDate != null ? #temporals.format(placement.startDate, 'yyyy-MM-dd''T''HH:mm') : ''}"
                       required />
              </div>
            </div>

            <div class="col-12 col-md-6">
              <label class="form-label">Tanggal Selesai</label>
              <div class="input-group">
                <span class="input-group-text bg-white input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                </span>
                <input type="datetime-local" class="form-control" name="endDate"
                       th:value="${placement.endDate != null ? #temporals.format(placement.endDate, 'yyyy-MM-dd''T''HH:mm') : ''}" />
              </div>
            </div>

            <div class="col-12 col-md-6">
              <label class="form-label">Status <span class="text-danger">*</span></label>
              <div class="input-group">
                <span class="input-group-text bg-white input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                </span>
                <select class="form-select" name="status" required>
                  <option th:each="st : ${statuses}" 
                          th:value="${st}" 
                          th:text="${st}"
                          th:selected="${placement.status == st}">
                  </option>
                </select>
              </div>
            </div>

          </div>
        </div>

        <div class="col-12 d-flex justify-content-end gap-2 mt-3">
          <button type="submit" class="btn-save">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-folder-check" viewBox="0 0 16 16">
              <path d="m.5 3 .04.87a2 2 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14H9v-1H2.826a1 1 0 0 1-.995-.91l-.637-7A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09L14.54 8h1.005l.256-2.819A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2m5.672-1a1 1 0 0 1 .707.293L7.586 3H2.19q-.362.002-.683.12L1.5 2.98a1 1 0 0 1 1-.98z" />
              <path d="M15.854 10.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.707 0l-1.5-1.5a.5.5 0 0 1 .707-.708l1.146 1.147 2.646-2.647a.5.5 0 0 1 .708 0" />
            </svg>
            Simpan Perubahan
          </button>
        </div>
      </form>
    </div>
  </main>

  <footer style="text-align:center;color:var(--muted);padding:1rem;margin-top:1rem;">
    &copy; <span th:text="${#dates.format(#dates.createNow(),'yyyy')}">2025</span> Sistem Monitoring
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>