<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tambah Placement - Sistem Monitoring</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root {
      --navy: #0b2340;
      --cream: #f2ece3;
      --accent: #b78b4a;
      --muted: #6c757d;
    }

    body {
      background: var(--cream);
      color: var(--navy);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      -webkit-font-smoothing: antialiased;
    }

    .container-main {
      max-width: 980px;
      margin: 2rem auto;
      background: #fff;
      border-radius: 12px;
      padding: 1.4rem 1.6rem;
      box-shadow: 0 2px 12px rgba(11, 35, 64, 0.06);
    }

    .title {
      display: flex;
      align-items: center;
      gap: .6rem;
      font-weight: 700;
      font-size: 1.25rem;
      color: var(--navy);
    }

    .title svg {
      width: 26px;
      height: 26px;
      stroke: var(--accent);
    }

    .form-section {
      margin-top: 1rem;
    }

    .form-label {
      font-weight: 600;
      color: var(--navy);
      margin-bottom: .35rem;
      display: block;
    }

    .input-icon svg {
      width: 18px;
      height: 18px;
      stroke: var(--navy);
    }

    .input-group-text {
      background: #fff;
      border-right: 0;
    }

    .form-control,
    .form-select {
      border-left: 0;
    }

    .btn-save {
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 8px;
      padding: .55rem 1rem;
      font-weight: 700;
      display: inline-flex;
      gap: .5rem;
      align-items: center;
    }

    .btn-save:hover {
      background: #a5793e;
      transform: translateY(-2px);
    }

    .btn-cancel {
      background: transparent;
      border: 1px solid rgba(11, 35, 64, 0.08);
      color: var(--navy);
      border-radius: 8px;
      padding: .45rem .9rem;
      font-weight: 600;
    }

    .small-note {
      color: var(--muted);
      font-size: .92rem;
      margin-top: .35rem;
    }

    footer.footer {
      text-align: center;
      color: var(--muted);
      margin-top: 1.2rem;
      font-size: .95rem;
    }

    @media (max-width: 576px) {
      .container-main {
        padding: 1rem;
      }
    }
  </style>
</head>

<body>
  <!-- include navbar + sidebar fragments (kalau ada) -->
  <div th:replace="~{layouts/fragments/navbar :: topbar}"></div>
  <div th:replace="~{layouts/fragments/sidebar :: sidebar}"></div>

  <main class="container-main">
    <div class="d-flex justify-content-between align-items-center">
      <div class="title">
        <!-- placement icon -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.6" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M3 7h18M8 7v4m8-4v4M4 21h16a2 2 0 002-2V7a2 2 0 00-2-2H4a2 2 0 00-2 2v12a2 2 0 002 2z" />
        </svg>
        Tambah Placement
      </div>

      <a th:href="@{/placements}" class="btn-cancel" hover="transform:translateY(-2px)">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
          class="size-3" width="18px" height="18px">
          <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
        </svg>
      </a>
    </div>

    <form th:action="@{/placements}" th:object="${placement}" method="post" class="form-section">
      <div class="row g-3">

        <!-- Student -->
        <div class="col-12 col-md-6">
          <label class="form-label">Siswa <span class="text-danger">*</span></label>
          <div class="input-group">
            <span class="input-group-text input-icon" aria-hidden="true">
              <!-- user icon -->
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.6">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M15.75 9a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.5 20.25a8.25 8.25 0 0115 0" />
              </svg>
            </span>
            <select class="form-select" name="studentId" required>
              <option value="" disabled selected>Pilih siswa</option>
              <option th:each="s : ${students}" th:value="${s.studentId}"
                th:text="${s.user != null ? s.user.username + ' — ' + (s.studentNumber != null ? s.studentNumber : '') : s.studentId}">
              </option>
            </select>
          </div>
        </div>

        <!-- Company -->
        <div class="col-12 col-md-6">
          <label class="form-label">Perusahaan <span class="text-danger">*</span></label>
          <div class="input-group">
            <span class="input-group-text input-icon" aria-hidden="true">
              <!-- building icon -->
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 21h18M9 8h6m-6 4h6M4 21V7h16v14z" />
              </svg>
            </span>
            <select class="form-select" name="companyId" required>
              <option value="" disabled selected>Pilih perusahaan</option>
              <option th:each="c : ${companies}" th:value="${c.companyId}" th:text="${c.companyName}"></option>
            </select>
          </div>
        </div>

        <!-- Company Supervisor -->
        <div class="col-12 col-md-6">
          <label class="form-label">Pembimbing Perusahaan</label>
          <div class="input-group">
            <span class="input-group-text input-icon" aria-hidden="true">
              <!-- tie/user icon -->
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 14l9-5-9-5-9 5 9 5zM12 14v7" />
              </svg>
            </span>
            <select class="form-select" name="companySupervisorId">
              <option value="">-- Tidak pilih --</option>
              <option th:each="cs : ${companySupervisors}" th:value="${cs.companySupervisorId}"
                th:text="${cs.user != null ? cs.user.username + ' — ' + (cs.company != null ? cs.company.companyName : '') : cs.companySupervisorId}">
              </option>
            </select>
          </div>
        </div>

        <!-- School Supervisor -->
        <div class="col-12 col-md-6">
          <label class="form-label">Pembimbing Sekolah</label>
          <div class="input-group">
            <span class="input-group-text input-icon" aria-hidden="true">
              <!-- school icon -->
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 3l9 4-9 5-9-5 9-4zM12 7v14" />
              </svg>
            </span>
            <select class="form-select" name="schoolSupervisorId">
              <option value="">-- Tidak pilih --</option>
              <option th:each="ss : ${schoolSupervisors}" th:value="${ss.schoolSupervisorId}"
                th:text="${ss.user != null ? ss.user.username + ' — ' + (ss.position != null ? ss.position : '') : ss.schoolSupervisorId}">
              </option>
            </select>
          </div>
        </div>

        <!-- Start Date -->
        <div class="col-12 col-md-6">
          <label class="form-label">Tanggal Mulai <span class="text-danger">*</span></label>
          <div class="input-group">
            <span class="input-group-text input-icon" aria-hidden="true">
              <!-- calendar icon -->
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.6">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M8 7V3m8 4V3M3 11h18M5 21h14a2 2 0 002-2V7H3v12a2 2 0 002 2z" />
              </svg>
            </span>
            <!-- controller expects ISO_LOCAL_DATE_TIME string 'yyyy-MM-dd'T'HH:mm' -->
            <input type="datetime-local" class="form-control" name="startDate" required />
          </div>
        </div>

        <!-- End Date -->
        <div class="col-12 col-md-6">
          <label class="form-label">Tanggal Selesai <span class="text-danger">*</span></label>
          <div class="input-group">
            <span class="input-group-text input-icon" aria-hidden="true">
              <!-- calendar check icon -->
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.6">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M9 11l3 3L22 4M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V7" />
              </svg>
            </span>
            <input type="datetime-local" class="form-control" name="endDate" required />
          </div>
        </div>

        <!-- Status -->
        <div class="col-12 col-md-6">
          <label class="form-label">Status</label>
          <div class="input-group">
            <span class="input-group-text input-icon" aria-hidden="true">
              <!-- status icon -->
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 5v14M5 12h14" />
              </svg>
            </span>
            <select class="form-select" name="status">
              <option th:each="st : ${statuses}" th:value="${st}" th:text="${st}">PENDING</option>
            </select>
          </div>
          <div class="small-note">Jika tidak dipilih, status akan di-set ke <strong>PENDING</strong>.</div>
        </div>

        <!-- tombol -->
        <div class="col-12 d-flex justify-content-end gap-2 mt-3">
          <button type="submit" class="btn-save">
            <!-- save icon -->
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
              class="bi bi-folder-check" viewBox="0 0 16 16">
              <path
                d="m.5 3 .04.87a2 2 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14H9v-1H2.826a1 1 0 0 1-.995-.91l-.637-7A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09L14.54 8h1.005l.256-2.819A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2m5.672-1a1 1 0 0 1 .707.293L7.586 3H2.19q-.362.002-.683.12L1.5 2.98a1 1 0 0 1 1-.98z" />
              <path
                d="M15.854 10.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.707 0l-1.5-1.5a.5.5 0 0 1 .707-.708l1.146 1.147 2.646-2.647a.5.5 0 0 1 .708 0" />
            </svg>
            Simpan
          </button>
        </div>

      </div>
    </form>
  </main>

  <footer class="footer">
    &copy; <span th:text="${#dates.format(#dates.createNow(),'yyyy')}">2025</span> Sistem Monitoring
  </footer>

  <script>
    // Optional: set default datetime-local values (local timezone) to now and +30 days for convenience
    (function () {
      try {
        const pad = (n) => n.toString().padStart(2, '0');
        const toLocalInput = (d) => {
          const yyyy = d.getFullYear();
          const mm = pad(d.getMonth() + 1);
          const dd = pad(d.getDate());
          const hh = pad(d.getHours());
          const min = pad(d.getMinutes());
          return `${yyyy}-${mm}-${dd}T${hh}:${min}`;
        };
        const startEl = document.querySelector('input[name="startDate"]');
        const endEl = document.querySelector('input[name="endDate"]');
        if (startEl && !startEl.value) startEl.value = toLocalInput(new Date());
        if (endEl && !endEl.value) {
          const later = new Date();
          later.setDate(later.getDate() + 30);
          endEl.value = toLocalInput(later);
        }
      } catch (e) {
        // ignore silently
      }
    })();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>