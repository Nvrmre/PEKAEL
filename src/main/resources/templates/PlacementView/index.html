<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Daftar Placement - Sistem Monitoring</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root {
      --navy: #0b2340;
      --cream: #f2ece3;
      --accent: #b78b4a;
      --muted: #6c757d;
    }

    body {
      background: var(--cream);
      color: var(--navy);
      font-size: 1rem;
    }

    .topbar {
      background: linear-gradient(180deg, rgba(11, 35, 64, 0.97), rgba(11, 35, 64, 0.93));
      color: #fff;
      padding: .7rem 1rem;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
    }

    .brand {
      font-weight: 700;
      font-size: 1.15rem;
    }

    .container-main {
      max-width: 1100px;
      margin: 1.8rem auto;
      padding: 1.25rem;
    }

    .card-page {
      background: #fff;
      border-radius: 12px;
      padding: 1.25rem;
      box-shadow: 0 3px 12px rgba(11, 35, 64, 0.06);
    }

    .title {
      display: flex;
      align-items: center;
      gap: .6rem;
      font-weight: 700;
      font-size: 1.25rem;
    }

    .title svg {
      width: 26px;
      height: 26px;
      stroke: var(--accent);
    }

    .btn-add {
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: .45rem .8rem;
      display: inline-flex;
      gap: .4rem;
      align-items: center;
      font-weight: 700;
    }

    .btn-add:hover {
      background: #a5793e;
      transform: translateY(-2px);
    }

    table thead {
      background: rgba(11, 35, 64, 0.03);
    }

    th {
      font-weight: 600;
      color: var(--navy);
    }

    td,
    th {
      vertical-align: middle;
    }

    .badge-status {
      font-weight: 700;
      border-radius: 6px;
      padding: .38rem .6rem;
    }

    .status-PENDING {
      background: #f0f0f0;
      color: var(--muted);
      border-left: 4px solid var(--accent);
    }

    .status-ACTIVE {
      background: #e6f6ea;
      color: #1f7a35;
    }

    .status-COMPLETED {
      background: #eef6ff;
      color: #0b5b9a;
    }

    .status-CANCELLED {
      background: #fff0f0;
      color: #9a2e2e;
    }

    .actions .btn {
      border-radius: 8px;
      padding: .35rem .6rem;
      font-weight: 600;
    }

    .actions .btn-edit {
      background: #0b74a4;
      color: #fff;
      border: none;
    }

    .actions .btn-delete {
      background: #c44d3a;
      color: #fff;
      border: none;
    }

    .empty-state {
      color: var(--muted);
      padding: 2.2rem;
      text-align: center;
    }

    footer {
      text-align: center;
      color: var(--muted);
      padding: 1rem;
      margin-top: 1rem;
    }
  </style>
</head>

<body>
  <div th:replace="~{layouts/fragments/navbar :: topbar}"></div>
  <div th:replace="~{layouts/fragments/sidebar :: sidebar}"></div>

  <div id="pageOverlay" class="overlay" aria-hidden="true"></div>

  <main class="container-main">
    <div class="card-page">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="title">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"
            stroke-width="1.6">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M3 7h18M8 7v4m8-4v4M4 21h16a2 2 0 002-2V7a2 2 0 00-2-2H4a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          Daftar Placement
        </div>

        <div class="d-flex gap-2">
          <a th:href="@{/placements/create}" class="btn-add">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor"
              stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
            </svg>
            Tambah Placement
          </a>
        </div>
      </div>

      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead>
            <tr>
              <th style="width:56px">#</th>
              <th>Student</th>
              <th>Company</th>
              <th>Supervisor (Company)</th>
              <th>Start — End</th>
              <th>Status</th>
              <th style="width:170px">Aksi</th>
            </tr>
          </thead>

          <tbody>
            <tr th:each="p, stat : ${placements}">
              <td th:text="${stat.count}">1</td>

              <td>
                <div><strong
                    th:text="${p.student != null && p.student.user != null ? p.student.user.username : '-'}">Nama
                    Siswa</strong></div>
                <div class="text-muted small"
                  th:text="${p.student != null ? (p.student.studentNumber != null ? 'NIS: ' + p.student.studentNumber : '') : ''}">
                  NIS: 123</div>
              </td>

              <td>
                <div th:text="${p.company != null ? p.company.companyName : '-'}">PT Contoh</div>
                <div class="text-muted small" th:text="${p.location != null ? p.location : ''}">Jakarta</div>
              </td>

              <td>
                <div
                  th:text="${p.companySupervisor != null && p.companySupervisor.user != null ? p.companySupervisor.user.username : (p.schoolSupervisor != null && p.schoolSupervisor.user != null ? p.schoolSupervisor.user.username : '-')}">
                  Supervisor</div>
                <div class="text-muted small"
                  th:text="${p.companySupervisor != null ? (p.companySupervisor.jobTitle != null ? p.companySupervisor.jobTitle : '') : (p.schoolSupervisor != null ? (p.schoolSupervisor.position != null ? p.schoolSupervisor.position : '') : '')}">
                  Jabatan</div>
              </td>

              <td>
                <div
                  th:text="${p.startDate != null && p.endDate != null ? #dates.format(p.startDate,'dd MMM yyyy HH:mm') + ' — ' + #dates.format(p.endDate,'dd MMM yyyy HH:mm') : (p.startDate != null ? #dates.format(p.startDate,'dd MMM yyyy HH:mm') : '-')}">
                  01 Jan 2025 — 31 Mar 2025</div>
              </td>

              <td>
                <span th:text="${p.status != null ? p.status.name() : 'PENDING'}"
                  th:classappend="${p.status != null ? ' status-' + p.status.name() : ' status-PENDING'}"
                  class="badge-status">
                  PENDING
                </span>
              </td>

              <td class="actions">
                <div class="d-flex gap-2">
                  <a th:href="@{'/placements/edit/' + ${p.id}}" class="btn btn-edit btn-sm d-flex align-items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="currentColor"
                      stroke-width="1.6" class="me-1">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M11 4h6m-6 4h6M6 20h12" />
                    </svg>
                    Edit
                  </a>

                  <form th:action="@{'/placements/' + ${p.id}}" method="post" style="display:inline;">
                    <input type="hidden" name="_method" value="delete" />
                    <button type="submit" class="btn btn-delete btn-sm"
                      onclick="return confirm('Yakin ingin menghapus placement ini?')">
                      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="currentColor"
                        stroke-width="1.6" class="me-1">
                        <path stroke-linecap="round" stroke-linejoin="round"
                          d="M6 7h12M9 7v10a2 2 0 002 2h2a2 2 0 002-2V7" />
                      </svg>
                      Hapus
                    </button>
                  </form>
                </div>
              </td>
            </tr>
            <tr th:if="${#lists.isEmpty(placements)}">
              <td colspan="7" class="text-center text-muted py-4">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="none" stroke="currentColor"
                  stroke-width="1.8" class="me-1">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 17v-2m0-4v-2m6 8v-2m0-4v-2M4 4h16v16H4z" />
                </svg>
                <div>Tidak ada data placement.</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <footer>
    &copy; <span th:text="${#dates.format(#dates.createNow(),'yyyy')}">2025</span> Sistem Monitoring
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>